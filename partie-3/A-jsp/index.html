<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.2">
<title>Annexe A : Les Java Server Pages (JSP)</title>
<link rel="stylesheet" href="./../../style.css">
<link rel="stylesheet" href="./coderay-asciidoctor.css">
</head>
<body class="article">
<div id="header">
<h1>Annexe A : Les Java Server Pages (JSP)</h1>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Les JSP sont la technologie de templating</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="jsp">&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=UTF-8&quot; pageEncoding=&quot;UTF-8&quot;%&gt;
&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot; &quot;http://www.w3.org/TR/html4/loose.dtd&quot;&gt;
&lt;html&gt;
   &lt;head&gt;&lt;/head&gt;
   &lt;body&gt;
      Hello ${name} !&lt;br&gt;
      Hello &lt;%=name%&gt; !&lt;br&gt;
   &lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Ils disposent de mécaniques puissantes afin de créer le rendu html pour une page web.</p>
</div>
<div class="paragraph">
<p>Ils peuvent également générer n&#8217;importe quel type de contenu textuel, comme du XML par exemple.</p>
</div>
<div class="paragraph">
<p>Les jsp sont compilées en servlet java au moment de leur interprétation, avant d&#8217;être exécutées.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_les_directives_jsp">Les directives jsp</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Les directives contrôlent la manière dont le compilateur doit générer la servlet.</p>
</div>
<div class="paragraph">
<p>Le format d&#8217;une directive est le suivant.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="jsp">&lt;%@ directive { attribut=&quot;valeur&quot; } %&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Par exemple afin de contrôler le type mime et l&#8217;encoding de la page.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="jsp">&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=UTF-8&quot; pageEncoding=&quot;UTF-8&quot;%&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Ou bien l&#8217;inclusion d&#8217;un autre fichier.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="jsp">&lt;%@ include file=&quot;autre_fichier.jsp&quot; %&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_les_actions_jsp">Les actions jsp</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Les actions JSP sont des balises qui appellent des fonctions sur serveur HTTP</p>
</div>
<div class="paragraph">
<p>Le format d&#8217;une action est le suivant.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="jsp">&lt;jsp:action { attribut=&quot;valeur&quot; } /&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Par exemple, un include s&#8217;écrit comme suit.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="jsp">&lt;jsp:include page=&quot;autre_fichier.jsp&quot; &gt;
   &lt;jsp:param name=&quot;monParam&quot; value=&quot;valeur&quot; /&gt;
&lt;/jsp:include&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>En pratique, les actions sont peu utilisées car il existe des mécanismes plus puissants.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_variables_implicites">Variables implicites</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Les variables implicites sont des variables qui sont présentes dans toutes les jsp.</p>
</div>
<div class="paragraph">
<p>En voici quelques unes</p>
</div>
<div class="ulist">
<ul>
<li>
<p>out : le JSPWriter utilisé pour envoyer la réponse HTTP au client</p>
</li>
<li>
<p>page : la Servlet elle même</p>
</li>
<li>
<p>pageContext : les données associées à la page entière</p>
</li>
<li>
<p>request : la requête</p>
</li>
<li>
<p>response : la réponse</p>
</li>
<li>
<p>session : la session</p>
</li>
<li>
<p>cookie : les cookies</p>
</li>
<li>
<p>header : tous les headers</p>
</li>
<li>
<p>param : tous paramètres</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Il est rare d&#8217;avoir recours à ces variables dans les jsp car dans le cadre du MVC, c&#8217;est le rôle du contrôleur.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_expression_language">Expression language</h2>
<div class="sectionbody">
<div class="paragraph">
<p>C&#8217;est une notation simple et puissante utilisable partout dans les jsp.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="jsp">${expression}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Elle permet d&#8217;aller chercher des valeurs en parcourant tous les scopes (page, request, session et application) et d&#8217;effectuer des opérations.</p>
</div>
<div class="paragraph">
<p>L&#8217;expression suivante</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="jsp">${cart.items[2].name}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Synthétise un appel qui pourrait être écrit comme suit</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="jsp">Cart cart = (Cart) request.getSession().getAttribute(&quot;cart&quot;);

String name = cart.getItems().get(2).getName();

response.getWriter().write(name);</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_custom_tags_et_fonctions">Custom tags et fonctions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Un custom tag est un nouvel élément du language que l&#8217;on peut soi même définir.</p>
</div>
<div class="paragraph">
<p>Afin de pouvoir l&#8217;utiliser, il suffit d&#8217;utiliser la directive taglib suivante.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="jsp">&lt;%@ taglib uri=&quot;/WEB-INF/tld/mataglib.tld&quot; prefix=&quot;mataglib&quot; %&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Une taglib peut contenir des tags et des fonctions.</p>
</div>
<div class="paragraph">
<p>Les tags, selon le besoin, peuvent être implémentés par des classes java ou bien des fichiers tag.</p>
</div>
<div class="paragraph">
<p>Voici un exemple d&#8217;appel à un tag.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="jsp">&lt;mataglib:faituntruc att1=&quot;valeur1&quot; att2=&quot;valeur2&quot; &gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Et une fonction.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="jsp">${mataglib:faitca(&quot;valeur1&quot;)}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_tag_files">Tag files</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_jstl">Jstl</h2>
<div class="sectionbody">
<div class="paragraph">
<p>La java standard tag library est la librairie de tag la plus utilisée.</p>
</div>
<div class="paragraph">
<p>Elle contient 4 taglibs et un ensemble de fonctions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>&lt;c:/&gt; : la taglib essentielle avec le contrôle de flot</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="jsp">&lt;c:if test=&quot;${empty param['name']}&quot;&gt;Nom inconnu&lt;/c:if&gt;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>&lt;fmt:/&gt; : le fomattage</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="jsp">&lt;fmt:formatDate value=&quot;${date}&quot; pattern=&quot;dd/MM/yyyy&quot;/c:if&gt;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>&lt;sql:/&gt; : l&#8217;accès aux bases de données</p>
</li>
<li>
<p>&lt;x:/&gt; : le parsing xml</p>
</li>
<li>
<p>${fn:} : la manipulation de chaînes de charactères</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="jsp">${fn:escapeXml(&quot;les &lt;balises&gt; xml &amp; html&quot;)} &lt;%-- &quot;les &amp;lt;balises&amp;gt; xml &amp;amp; html&quot; --%&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
</body>
</html>